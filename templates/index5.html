<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta property="og:title" content="항해99 6기 9조"/>
    <meta property="og:description" content="우리동네 빵집"/>
    <meta property="og:image" content="이미지URL주소입력"/>

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <script src="/path/to/jquery.js"></script>
    <script src="/path/to/jquery.cookie.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">

    <title>Detail | 동네빵집</title>

    <!-- 지도 api-->
    <script type="text/javascript"
            src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=y988czmmp0&submodules=geocoder"></script>

    <style>
        * {
            font-family: 'Nanum Gothic', sans-serif;
            color: #40E0D0;
        }

        body {
            background-color: #FFFFF0;
            text-align: center;
            min-height: 100vh;
            height: 100%;
            font-family: 'Nanum Pen Script', cursive;
        }

        .mainbox {
            background-color: white;
            position: absolute;
            max-width: 90%;
            height: 90%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 30px;
        }

        .mybtn {
            position: fixed;
            right: 60px;
            top: 20px;
            z-index: 10;

        }

        .title {
            font-family: 'Gugi', cursive;
            margin-top: 20px;
            color: #40E0D0;
            font-size: 4rem;
        }

        #star {
            margin-bottom: 30px;
        }

        .comment-box {
            width: 600px;
        }

        .card-image {
            width: 300px;
            padding: 10px;
            border-radius: 15px;
        }

        .wrap {
            min-width: 800px;
            width: 90%;
            margin: auto;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #map {
            margin-top: 20px;
            max-width: 85%;
            height: 200px;
            width: 300px;
        }


    </style>

    <script>
        let y_cen = 37.4981125   // lat
        let x_cen = 127.0379399  // long
        let map;
        let markers = []
        $(document).ready(function () {
            init_page() // 받은 빵집의 정보를 바탕으로 페이지의 정보를 초기화합니다.
            map = new naver.maps.Map('map', {
                center: new naver.maps.LatLng(y_cen, x_cen),
                zoom: 12,
                zoomControl: true,
                zoomControlOptions: {
                    style: naver.maps.ZoomControlStyle.SMALL,
                    position: naver.maps.Position.TOP_RIGHT
                }
            });

            make_map();
        })

        function init_page() {
            // $('#review_list').empty()
            $.ajax({
                type: "GET",
                url: "/index5_show?num_give=" + '{{num}}', // app.py에서 num_give로 받은 정보를 활용해 검색 후 데이터를 받아옵니다. flask를 통해 받은 데이터는 {{데이터}} 로 활용이 가능해요.
                data: {},
                success: function (response) {
                    let rows = response['review_list']

                    document.getElementById("store").innerHTML = rows['store']
                    document.getElementById("localname").innerHTML = rows['localname']
                    document.getElementById("star").innerHTML = '⭐'.repeat(rows['star'])
                    document.getElementById("id").innerHTML = rows['username']
                    document.getElementById("image").innerHTML = rows['image']
                    document.getElementById("menu").innerHTML = rows['menu']
                    document.getElementById("comment").innerHTML = rows['comment']

                }

            })
        }

        function make_map() {
            $.ajax({
                type: "GET",
                url: "/index5_map?num_give=" + '{{num}}', // app.py에서 num_give로 받은 정보를 활용해 검색 후 데이터를 받아옵니다. flask를 통해 받은 데이터는 {{데이터}} 로 활용이 가능해요.
                data: {},
                success: function (response) {
                    let rows = response['review_list']

                    map = new naver.maps.Map('map', { //지도를 띄운다
                        center: new naver.maps.LatLng(rows['address_y'], rows['address_x']),
                        zoom: 15
                        });

                    marker = new naver.maps.Marker({ //지도에 마커를 띄운다
                        position: new naver.maps.LatLng(rows['address_y'], rows['address_x']), //어느 위치에
                        map: map
                        });
                    }

                })

        }
    </script>


</head>
<body>

<button class="mybtn" onclick="window.location.href='/'">
    목록으로 가기
</button>

<section class="mainbox">

    <h1 class="title" id="store"></h1>
    <h4 id="localname"></h4>
    <h5 id="star"></h5>

    <div class="wrap" id="review_list">

        <div class="card-image">
            <figure class="image is-4by3">
                <img id="image" src="#" alt="bread">
            </figure>
        </div>
        <div class="card-body">
            <span>추천메뉴: </span> <span class="card-text" id="menu">${menu}</span>
        </div>

        <div class="comment-box">
            <textarea id="comment" class="textarea is-primary" placeholder="Primary textarea"></textarea>
        </div>

        <div id="map"></div>

        <div class="user">
            작성자: <span id="id"></span>
        </div>

    </div>
</section>


</body>
</html>